# {{ ansible_managed }}
# Authentik Environment Configuration

###############################################################################
# PostgreSQL Database
###############################################################################
POSTGRES_DB={{ authentik_postgres_db }}
POSTGRES_USER={{ authentik_postgres_user }}
POSTGRES_PASSWORD={{ authentik_postgres_password }}

###############################################################################
# Authentik Database Connection
###############################################################################
AUTHENTIK_POSTGRESQL__HOST=postgresql
AUTHENTIK_POSTGRESQL__PORT=5432
AUTHENTIK_POSTGRESQL__NAME={{ authentik_postgres_db }}
AUTHENTIK_POSTGRESQL__USER={{ authentik_postgres_user }}
AUTHENTIK_POSTGRESQL__PASSWORD={{ authentik_postgres_password }}

###############################################################################
# Redis
###############################################################################
AUTHENTIK_REDIS__HOST=redis
AUTHENTIK_REDIS__PORT=6379

###############################################################################
# Application Settings
###############################################################################
AUTHENTIK_SECRET_KEY={{ authentik_secret_key }}
AUTHENTIK_LOG_LEVEL={{ authentik_log_level | default('info') }}

###############################################################################
# Outpost Configuration
###############################################################################
AUTHENTIK_OUTPOSTS__DISABLE_EMBEDDED_OUTPOST=true

###############################################################################
# Update Check (disabled - no outbound DNS needed)
###############################################################################
AUTHENTIK_DISABLE_UPDATE_CHECK=true

###############################################################################
# Error Reporting (disabled for privacy)
###############################################################################
AUTHENTIK_ERROR_REPORTING__ENABLED={{ authentik_error_reporting_enabled }}
AUTHENTIK_ERROR_REPORTING__ENVIRONMENT={{ authentik_error_reporting_environment }}
AUTHENTIK_ERROR_REPORTING__SEND_PII={{ authentik_error_reporting_send_pii }}

###############################################################################
# Email Configuration (optional)
###############################################################################
{% if authentik_smtp_host is defined %}
AUTHENTIK_EMAIL__HOST={{ authentik_smtp_host }}
AUTHENTIK_EMAIL__PORT={{ authentik_smtp_port | default(465) }}
AUTHENTIK_EMAIL__USERNAME={{ authentik_smtp_username }}
AUTHENTIK_EMAIL__PASSWORD={{ authentik_smtp_password }}
AUTHENTIK_EMAIL__USE_TLS={{ authentik_smtp_use_tls | default('true') | lower }}
AUTHENTIK_EMAIL__USE_SSL={{ authentik_smtp_use_ssl | default('true') | lower }}
AUTHENTIK_EMAIL__FROM={{ authentik_email_from }}
{% endif %}
